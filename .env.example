# ================================================
# VeloCards Backend Environment Configuration
# ================================================
# Copy this file to .env and fill in your values
# See docs/configuration/CONFIG-REFERENCE.md for detailed documentation

# ============================================
# Application Environment
# ============================================
# Environment mode: development | test | production
NODE_ENV=development
# Server port (default: 3001)
PORT=3001
# Public API base URL
API_BASE_URL=http://localhost:3001

# ============================================
# Database Configuration (REQUIRED)
# ============================================
# PostgreSQL connection string
DATABASE_URL=postgresql://user:password@localhost:5432/velocards
# Supabase project URL
SUPABASE_URL=https://your-project.supabase.co
# Supabase service role key (SENSITIVE - keep secret!)
SUPABASE_SERVICE_KEY=your-service-key-here

# ============================================
# Redis Configuration (REQUIRED)
# ============================================
# Primary Redis URL (Railway for dev, Upstash for prod)
REDIS_URL=redis://localhost:6379
# Upstash Redis URL for production (optional)
REDIS_UPSTASH_URL=
# Enable Upstash Redis in production
USE_UPSTASH_REDIS=false

# ============================================
# JWT Configuration (REQUIRED)
# ============================================
# Generate using: openssl rand -hex 32
JWT_ACCESS_SECRET=generate-64-character-hex-string
JWT_REFRESH_SECRET=generate-another-64-character-hex-string
# Token expiration times
JWT_ACCESS_EXPIRY=24h
JWT_REFRESH_EXPIRY=7d

# ============================================
# AdMediaCards Integration (REQUIRED)
# ============================================
ADMEDIACARDS_API_KEY=your-api-key
ADMEDIACARDS_API_SECRET=
ADMEDIACARDS_BASE_URL=https://openapi.admediacards.com
ADMEDIACARDS_WEBHOOK_SECRET=
ADMEDIACARDS_ACCOUNT_ID=your-account-id
ADMEDIACARDS_WEBHOOK_URL=https://your-api.com/api/webhooks/admediacards
# Enable test mode for development
ADMEDIACARDS_TEST_MODE=true
# Maximum test cards allowed
ADMEDIACARDS_MAX_TEST_CARDS=100

# ============================================
# xMoney Crypto Integration (REQUIRED)
# ============================================
XMONEY_API_KEY=your-xmoney-api-key
XMONEY_WEBHOOK_SECRET=your-webhook-secret
# Use live environment (false for sandbox)
XMONEY_USE_LIVE=false
XMONEY_LIVE_API_URL=https://merchants.api.crypto.xmoney.com/api
XMONEY_SANDBOX_API_URL=https://merchants.api.sandbox.crypto.xmoney.com/api
# API timeout in milliseconds
XMONEY_API_TIMEOUT=30000
# Redirect URLs for crypto payments
XMONEY_RETURN_URL=http://localhost:3000/crypto/success
XMONEY_CANCEL_URL=http://localhost:3000/crypto/cancel
XMONEY_CALLBACK_URL=http://localhost:3001/api/v1/webhooks/xmoney

# ============================================
# Crypto Business Rules (REQUIRED)
# ============================================
DEFAULT_COUNTRY_CODE=US
MIN_DEPOSIT_AMOUNT=10
MAX_DEPOSIT_AMOUNT=10000
# Fee as decimal (0.02 = 2%)
WITHDRAWAL_FEE_PERCENTAGE=0.02
# Cache TTL in milliseconds (5 minutes)
EXCHANGE_RATE_CACHE_TTL_MS=300000

# ============================================
# KYC Provider Configuration (REQUIRED)
# ============================================
# Provider: sumsub | jumio
KYC_PROVIDER=sumsub
KYC_API_URL=https://api.sumsub.com
KYC_API_KEY=your-kyc-api-key
KYC_SECRET_KEY=your-kyc-secret-key

# ============================================
# Email Service (REQUIRED)
# ============================================
# Primary email provider
RESEND_API_KEY=your-resend-api-key
# Fallback email provider
SENDGRID_API_KEY=your-sendgrid-api-key
# Sender configuration
FROM_EMAIL=noreply@example.com
FROM_NAME=VeloCards
INVOICE_FROM_EMAIL=invoices@example.com
INVOICE_FROM_NAME=VeloCards Billing
# Frontend application URL
FRONTEND_URL=http://localhost:3000

# ============================================
# SMS Service - Twilio (REQUIRED)
# ============================================
TWILIO_ACCOUNT_SID=your-twilio-sid
TWILIO_AUTH_TOKEN=your-twilio-token
TWILIO_PHONE_NUMBER=+1234567890

# ============================================
# Security Configuration (REQUIRED)
# ============================================
# Generate using: openssl rand -hex 32
ENCRYPTION_KEY=generate-64-character-hex-string
# Password hashing rounds (12-14 recommended)
BCRYPT_ROUNDS=12
# Cloudflare Turnstile for bot protection
TURNSTILE_SECRET_KEY=your-turnstile-secret
# CSRF protection secret
CSRF_SECRET=generate-64-character-hex-string
# Session encryption
SESSION_SECRET=generate-64-character-hex-string
# 2FA encryption key
TWO_FA_ENCRYPTION_KEY=generate-64-character-hex-string

# ============================================
# Rate Limiting
# ============================================
# Comma-separated IPs to bypass rate limiting
RATE_LIMIT_WHITELIST_IPS=127.0.0.1,::1

# ============================================
# Admin Configuration
# ============================================
# Comma-separated admin email addresses
ADMIN_EMAILS=admin@example.com

# ============================================
# Logging and Monitoring (REQUIRED)
# ============================================
# Log level: error | warn | info | debug
LOG_LEVEL=info
# Sentry error tracking DSN
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
# Optional release version
SENTRY_RELEASE=

# ============================================
# CORS Configuration (REQUIRED)
# ============================================
# Comma-separated allowed origins
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001

# ============================================
# Google OAuth (REQUIRED)
# ============================================
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_REDIRECT_URI=http://localhost:3001/api/v1/auth/google/callback

# ============================================
# Feature Flags (REQUIRED)
# ============================================
ENABLE_DEBUG_LOGS=true
MOCK_EXTERNAL_APIS=false
ENABLE_REGISTRATION=true
ENABLE_CARD_CREATION=true
ENABLE_CRYPTO_DEPOSITS=true
ENABLE_KYC_VERIFICATION=false
MAINTENANCE_MODE=false
# Development only flags
SKIP_EMAIL_VERIFICATION=false
SKIP_KYC_IN_DEV=true

# ============================================
# Card Configuration
# ============================================
MAX_ACTIVE_CARDS_PER_USER=10
DEFAULT_CARD_EXPIRY_YEARS=3
DEFAULT_CURRENCY=USD
REQUIRE_COMPLETE_PROFILE=true

# ============================================
# Development/Testing Defaults
# ============================================
DEFAULT_USER_FIRST_NAME=Card
DEFAULT_USER_LAST_NAME=Holder
DEFAULT_USER_ADDRESS=123 Main St
DEFAULT_USER_CITY=New York
DEFAULT_USER_STATE=NY
DEFAULT_USER_ZIP=10001
DEFAULT_USER_COUNTRY=US
DEFAULT_USER_PHONE=+12125551234

# ============================================
# Test Configuration
# ============================================
TEST_CARD_ID_START=100000
TEST_TRANSACTION_ID_START=200000
TEST_BIN_MASTERCARD=516830
TEST_BIN_VISA=428777

# ============================================
# File Upload Configuration
# ============================================
# Max file size in bytes (5MB)
MAX_FILE_SIZE=5242880
# Comma-separated MIME types
ALLOWED_FILE_TYPES=image/jpeg,image/png,application/pdf

# ============================================
# Repository Pattern Migration Flags
# ============================================
# Temporary flags for gradual migration
USE_NEW_REPOSITORIE=false
USE_NEW_AUDIT_LOG_REPO=false
USE_NEW_CRYPTO_PRICE_REPO=false
USE_NEW_CRYPTO_TRANSACTION_REPO=false
USE_NEW_SECURITY_KEY_REPO=false
USE_NEW_USER_BALANCE_LEDGER_REPO=false

# ============================================
# Additional Configuration
# ============================================
COMPANY_DOMAIN=velocards.com
# GitHub API token for automation
GITHUB_TOKEN=
